from bs4 import BeautifulSoup
import pickle
import requests
import threading

#rares = npcID: zoneName
#npcID is used on the webpage
rares = [
    14432,
    1531,
    14428,
    1936,
    14431,
    1533,
    14430,
    1137,
    5826,
    3068,
    5786,
    5808,
    5809,
    10356,
    99,
    471,
    1910,
    79,
    5807,
    1132,
    16855,
    5824,
    5822,
    5785,
    5823,
    16854,
    5787,
    8503,
    1260,
    14429,
    10357,
    61,
    1130,
    1911,
    472,
    10358,
    3056,
    100,
    1119,
    3535,
    5865,
    12431,
    2175,
    10359,
    2191,
    12432,
    3270,
    1425,
    12433,
    1424,
    3470,
    519,
    5837,
    14268,
    7017,
    2186,
    7015,
    5841,
    3672,
    5838,
    2184,
    14271,
    5829,
    3652,
    596,
    22062,
    22060,
    5835,
    599,
    506,
    14272,
    5912,
    14267,
    3586,
    5830,
    5842,
    520,
    5836,
    2192,
    5863,
    572,
    14266,
    3295,
    14270,
    3398,
    573,
    2172,
    3872,
    5831,
    1920,
    1399,
    14269,
    5797,
    5800,
    5864,
    5932,
    3735,
    1398,
    10559,
    7016,
    2476,
    10644,
    2283,
    1944,
    5828,
    616,
    14281,
    521,
    2090,
    10643,
    1948,
    12902,
    5931,
    5799,
    14279,
    5849,
    14425,
    5847,
    1112,
    3253,
    5832,
    1037,
    1720,
    5798,
    5834,
    14273,
    10641,
    5848,
    14424,
    4015,
    10639,
    4438,
    5859,
    3773,
    947,
    462,
    4425,
    5827,
    5851,
    4842,
    5916,
    14280,
    10642,
    14426,
    584,
    574,
    10640,
    5928,
    6228,
    5930,
    14275,
    14427,
    14278,
    5915,
    2108,
    4030,
    4066,
    14276,
    14433,
    5933,
    503,
    1140,
    12037,
    18241,
    3792,
    6490,
    6488,
    5934,
    6489,
    771,
    14223,
    507,
    10647,
    14277,
    14225,
    14228,
    534,
    2600,
    5937,
    14229,
    7895,
    14222,
    14221,
    2603,
    4132,
    2452,
    2751,
    5935,
    7354,
    2850,
    14230,
    14231,
    14487,
    14227,
    14236,
    1106,
    2606,
    14233,
    2258,
    7057,
    2753,
    4380,
    14232,
    14237,
    14488,
    2598,
    2602,
    14234,
    2453,
    763,
    2604,
    2749,
    2609,
    14226,
    2744,
    14235,
    2605,
    4339,
    14224,
    2779,
    2601,
    14491,
    14448,
    8211,
    5356,
    14492,
    11688,
    14446,
    14447,
    8208,
    5352,
    8219,
    2447,
    5354,
    8210,
    14490,
    2754,
    14445,
    10080,
    8199,
    10082,
    5345,
    2541,
    2752,
    1552,
    8218,
    10081,
    8200,
    12237,
    8279,
    8207,
    5343,
    1063,
    8203,
    5350,
    8280,
    5347,
    5346,
    8202,
    8296,
    8277,
    8216,
    8660,
    6118,
    5399,
    5400,
    5349,
    14339,
    8302,
    8214,
    8281,
    8212,
    6651,
    8215,
    6648,
    8303,
    8205,
    14344,
    8201,
    6581,
    3581,
    8283,
    8278,
    8204,
    8924,
    6650,
    8282,
    8213,
    6649,
    14342,
    8300,
    14345,
    6647,
    6652,
    9024,
    8217,
    13896,
    1847,
    14343,
    8299,
    6585,
    9042,
    8301,
    10077,
    6646,
    9041,
    8298,
    14340,
    6582,
    9604,
    9602,
    2931,
    10817,
    10197,
    9046,
    10078,
    7104,
    7137,
    8923,
    10827,
    10825,
    14476,
    1848,
    8297,
    8981,
    10263,
    10196,
    10558,
    6583,
    11383,
    14475,
    9219,
    8304,
    14472,
    10821,
    10826,
    10200,
    8978,
    1850,
    11498,
    10393,
    9218,
    9217,
    1849,
    1844,
    14477,
    14478,
    10822,
    1885,
    10202,
    9596,
    9718,
    10828,
    10509,
    11467,
    14474,
    10199,
    8979,
    10823,
    10376,
    8976,
    10198,
    6584,
    14473,
    11447,
    16184,
    1841,
    10809,
    11497,
    10119,
    10824,
    1837,
    14479,
    10899,
    10201,
    1838,
    14471,
    16380,
    18677,
    16379,
    1843,
    18678,
    1851,
    18679,
    1839,
    18682,
    18681,
    18680,
    18686,
    18685,
    18689,
    17144,
    18684,
    18694,
    18698,
    18692,
    18696,
    18690,
    18693,
    18683,
    18695,
    18697,
    20932,
    32358,
    32398,
    32377,
    32386,
    32361,
    14697,
    32357,
    32409,
    16179,
    16181,
    32417,
    32429,
    16180,
    32438,
    32400,
    38453,
    32422,
    32481,
    32471,
    32485,
    32517,
    32475,
    33776,
    32447,
    32487,
    32500,
    32501,
    32495,
    35189,
    32491,
    32630,
    32435
]

#final dictionary with all the soup objects that contain rarespawn data
rareSoupDict = {}

#npc id blank url
mapurl = "https://wowgaming.altervista.org/aowow/?npc="

#variables to display progress
counterProg = 0
rareAmounts = str(len(rares))

#used for threading
threads = []

#fetch rarespawn location data
def getRareData(nID):

    printString = ""

    #counter to visualize progress in command line when executed
    global counterProg
    counterProg += 1

    printString = str(counterProg)+" / "+rareAmounts+"\t\t"+str(nID)

    #build the final rarespawn id url
    url = mapurl + str(nID)
    #get webpage script data
    soup = BeautifulSoup(requests.get(url).text, "html.parser")

    rareSoupDict[nID] = soup

    print(printString)


#create threads for rares
for npcId in rares:
    t = threading.Thread(target=getRareData,args=[npcId])
    t.start()
    threads.append(t)

#join all threads together
for thread in threads:
    thread.join()


#write rare data to file
# [npcID] = [zoneName, websiteSoup]
with open("rareSoupDict.pkl", "wb") as df:
    pickle.dump(rareSoupDict, df)